{"version":3,"file":"mdtoc.min.js","sources":["../src/main.js"],"sourcesContent":["const MDTOC_DEFAULT_OPTIONS = {\r\n  name: 'mdtoc',\r\n  prefix: '',\r\n  filter: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']\r\n};\r\n\r\nfunction appendChild(root, child) {\r\n  let children = root.children;\r\n  if (children.length <= 0) {\r\n    children.push(\r\n      Object.assign({}, child, {\r\n        children: []\r\n      })\r\n    );\r\n  } else {\r\n    let _child = children[children.length - 1];\r\n    if (_child.heading >= child.heading) {\r\n      children.push(\r\n        Object.assign({}, child, {\r\n          children: []\r\n        })\r\n      );\r\n    } else {\r\n      appendChild(_child, child);\r\n    }\r\n  }\r\n}\r\n\r\nexport default function(selector, options) {\r\n  let md = null;\r\n  if (Object.prototype.toString.call(selector) === '[object String]') {\r\n    md = document.querySelector(selector);\r\n  } else if (selector instanceof HTMLElement) {\r\n    md = selector;\r\n  }\r\n\r\n  if (!md) {\r\n    throw new Error('invalid selector');\r\n  }\r\n\r\n  const _options = Object.assign({}, MDTOC_DEFAULT_OPTIONS, options);\r\n\r\n  let headings = Array.prototype.filter\r\n    .call(\r\n      md.childNodes || [],\r\n      node =>\r\n        node instanceof HTMLHeadingElement &&\r\n        (_options.filter || []).indexOf(node.tagName.toLowerCase()) >= 0\r\n    )\r\n    .map(node => ({\r\n      heading: parseInt(node.tagName[1]),\r\n      name: node.innerHTML,\r\n      link: '#' + _options.prefix + node.id\r\n    }));\r\n\r\n  let tocTree = {\r\n    heading: 0,\r\n    name: _options.name,\r\n    children: []\r\n  };\r\n\r\n  for (let i = 0; i < headings.length; i++) {\r\n    appendChild(tocTree, headings[i]);\r\n  }\r\n\r\n  return tocTree;\r\n}\r\n"],"names":["MDTOC_DEFAULT_OPTIONS","appendChild","root","child","children","length","push","Object","assign","_child","heading","selector","options","md","prototype","toString","call","document","querySelector","HTMLElement","Error","_options","headings","Array","filter","childNodes","node","HTMLHeadingElement","indexOf","tagName","toLowerCase","map","parseInt","innerHTML","prefix","id","tocTree","name","i"],"mappings":";;;;;iLAAA,IAAMA,EAAwB,MACtB,eACE,UACA,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,OAGzC,SAASC,EAAYC,EAAMC,OACrBC,EAAWF,EAAKE,YAChBA,EAASC,QAAU,IACZC,KACPC,OAAOC,OAAO,GAAIL,EAAO,UACb,UAGT,KACDM,EAASL,EAASA,EAASC,OAAS,GACpCI,EAAOC,SAAWP,EAAMO,UACjBJ,KACPC,OAAOC,OAAO,GAAIL,EAAO,UACb,QAIFM,EAAQN,WAKX,SAASQ,EAAUC,OAC5BC,EAAK,QACwC,oBAA7CN,OAAOO,UAAUC,SAASC,KAAKL,KAC5BM,SAASC,cAAcP,GACnBA,aAAoBQ,gBACxBR,IAGFE,QACG,IAAIO,MAAM,4BAGZC,EAAWd,OAAOC,OAAO,GAAIR,EAAuBY,GAEtDU,EAAWC,MAAMT,UAAUU,OAC5BR,KACCH,EAAGY,YAAc,GACjB,mBACEC,aAAgBC,oBAC+C,IAA9DN,EAASG,QAAU,IAAII,QAAQF,EAAKG,QAAQC,iBAEhDC,IAAI,kBAAS,SACHC,SAASN,EAAKG,QAAQ,SACzBH,EAAKO,eACL,IAAMZ,EAASa,OAASR,EAAKS,MAGnCC,EAAU,SACH,OACHf,EAASgB,cACL,IAGHC,EAAI,EAAGA,EAAIhB,EAASjB,OAAQiC,MACvBF,EAASd,EAASgB,WAGzBF"}